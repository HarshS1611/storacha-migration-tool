(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(6985)}])},6985:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return i}});var t=a(5893),r=a(7294);let c=e=>{let{percentage:s,color:a="storacha",height:r="md",showLabel:c=!0}=e,l=Math.min(100,Math.max(0,s)),i={sm:"h-1",md:"h-2",lg:"h-4"}[r];return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"w-full ".concat(i," bg-gray-200 rounded-full overflow-hidden"),children:(0,t.jsx)("div",{className:"".concat(i," ").concat({storacha:"bg-storacha",green:"bg-green-500",red:"bg-red-500"}[a]," rounded-full transition-all duration-500 ease-out"),style:{width:"".concat(l,"%")}})}),c&&(0,t.jsx)("div",{className:"mt-1 text-right",children:(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[Math.round(l),"%"]})})]})},l=()=>{var e,s,a,l,i,n,o,d,m,h,x,u;let[g,p]=(0,r.useState)({s3:{region:"",accessKeyId:"",secretAccessKey:"",bucketName:"",objectKey:""},storacha:{email:"",space:""}}),[b,y]=(0,r.useState)({}),[j,N]=(0,r.useState)(!1),[f,v]=(0,r.useState)({status:"idle",percentage:0,loaded:0,total:0,speed:0,timeRemaining:0}),[w,S]=(0,r.useState)(!1),K=()=>{let e={},s=!0;return g.s3.region||(e.s3={...e.s3,region:"Region is required"},s=!1),g.s3.accessKeyId||(e.s3={...e.s3,accessKeyId:"Access Key ID is required"},s=!1),g.s3.secretAccessKey||(e.s3={...e.s3,secretAccessKey:"Secret Access Key is required"},s=!1),g.s3.bucketName||(e.s3={...e.s3,bucketName:"Bucket Name is required"},s=!1),g.s3.objectKey||(e.s3={...e.s3,objectKey:"Object Key is required"},s=!1),g.storacha.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.storacha.email)||(e.storacha={...e.storacha,email:"Invalid email format"},s=!1):(e.storacha={...e.storacha,email:"Email is required"},s=!1),y(e),N(s),s};(0,r.useEffect)(()=>{K()},[g]);let k=e=>{let{name:s,value:a}=e.target,[t,r]=s.split(".");p(e=>({...e,[t]:{...e[t],[r]:a}}))},A=async e=>{if(e.preventDefault(),K())try{var s;S(!0),v({...f,status:"migrating",phase:"initializing",message:"Starting migration...",percentage:0});let e=await fetch("/api/storacha-upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({isS3Source:!0,s3Config:{region:g.s3.region,bucketName:g.s3.bucketName,credentials:{accessKeyId:g.s3.accessKeyId,secretAccessKey:g.s3.secretAccessKey}},s3Path:g.s3.objectKey,email:g.storacha.email,space:g.storacha.space})});if(!e.ok){let s=await e.json();throw Error(s.message||"Migration failed")}let a=null===(s=e.body)||void 0===s?void 0:s.getReader();if(!a)throw Error("Unable to read response stream");let t="";for(;;){let{done:e,value:s}=await a.read();if(e)break;let r=new TextDecoder().decode(s),c=(t+=r).split("\n");for(let e of(t=c.pop()||"",c))if(e.trim())try{let s=JSON.parse(e);s.phase&&v(e=>({...e,phase:s.phase,message:s.message,percentage:s.percentage||e.percentage,status:"completed"===s.phase?"completed":"error"===s.phase?"error":"migrating",cid:s.cid,url:s.url}))}catch(e){console.error("Error parsing progress update:",e)}}}catch(e){v(s=>({...s,status:"error",phase:"error",message:e instanceof Error?e.message:"Unknown error",error:e instanceof Error?e.message:"Unknown error"}))}finally{S(!1)}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-xl shadow-lg",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6 text-storacha",children:"S3 to Storacha Migration"}),(0,t.jsxs)("form",{onSubmit:A,className:"space-y-8",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"S3 Configuration"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Region ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"s3.region",value:g.s3.region,onChange:k,className:"input w-full ".concat((null===(e=b.s3)||void 0===e?void 0:e.region)?"border-red-500":""),placeholder:"e.g., us-east-1"}),(null===(s=b.s3)||void 0===s?void 0:s.region)&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:b.s3.region})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Bucket Name ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"s3.bucketName",value:g.s3.bucketName,onChange:k,className:"input w-full ".concat((null===(a=b.s3)||void 0===a?void 0:a.bucketName)?"border-red-500":""),placeholder:"e.g., my-bucket"}),(null===(l=b.s3)||void 0===l?void 0:l.bucketName)&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:b.s3.bucketName})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Access Key ID ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"password",name:"s3.accessKeyId",value:g.s3.accessKeyId,onChange:k,className:"input w-full ".concat((null===(i=b.s3)||void 0===i?void 0:i.accessKeyId)?"border-red-500":""),placeholder:"Enter your AWS Access Key ID"}),(null===(n=b.s3)||void 0===n?void 0:n.accessKeyId)&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:b.s3.accessKeyId})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Secret Access Key ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"password",name:"s3.secretAccessKey",value:g.s3.secretAccessKey,onChange:k,className:"input w-full ".concat((null===(o=b.s3)||void 0===o?void 0:o.secretAccessKey)?"border-red-500":""),placeholder:"Enter your AWS Secret Access Key"}),(null===(d=b.s3)||void 0===d?void 0:d.secretAccessKey)&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:b.s3.secretAccessKey})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Object Key ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",name:"s3.objectKey",value:g.s3.objectKey,onChange:k,className:"input w-full ".concat((null===(m=b.s3)||void 0===m?void 0:m.objectKey)?"border-red-500":""),placeholder:"e.g., path/to/file.txt"}),(null===(h=b.s3)||void 0===h?void 0:h.objectKey)&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:b.s3.objectKey})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"Storacha Configuration"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"email",name:"storacha.email",value:g.storacha.email,onChange:k,className:"input w-full ".concat((null===(x=b.storacha)||void 0===x?void 0:x.email)?"border-red-500":""),placeholder:"Enter your Storacha email"}),(null===(u=b.storacha)||void 0===u?void 0:u.email)&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-500",children:b.storacha.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Space Name ",(0,t.jsx)("span",{className:"text-gray-400",children:"(Optional)"})]}),(0,t.jsx)("input",{type:"text",name:"storacha.space",value:g.storacha.space,onChange:k,className:"input w-full",placeholder:"Enter space name (optional)"})]})]})]}),"idle"!==f.status&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"Migration Progress"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(c,{percentage:f.percentage,color:"completed"===f.status?"green":"error"===f.status?"red":"storacha"}),f.message&&(0,t.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,t.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-gray-700",children:f.message})}),f.error&&(0,t.jsx)("div",{className:"bg-red-50 p-4 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-red-700",children:f.error})}),f.cid&&(0,t.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Migration Successful!"}),(0,t.jsxs)("p",{className:"text-sm text-green-600",children:["CID: ",f.cid]}),f.url&&(0,t.jsx)("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-storacha hover:underline",children:"View File â†’"})]})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"submit",disabled:!j||w,className:"\n              px-6 py-2 rounded-lg font-medium text-white\n              ".concat(j&&!w?"bg-storacha hover:bg-storacha-600 focus:ring-2 focus:ring-storacha-500 focus:ring-offset-2":"bg-gray-300 cursor-not-allowed","\n              transition-colors duration-200\n            "),children:w?"Migrating...":"Start Migration"})})]})]})};function i(){return(0,t.jsxs)("div",{className:"space-y-10",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"S3 to Storacha Migration Demo"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Migrate files directly from S3 to Storacha with detailed progress tracking"})]}),(0,t.jsx)(l,{}),(0,t.jsxs)("div",{className:"text-center p-6 bg-gray-50 rounded-xl",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"How It Works"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"This demo showcases the capabilities of the storacha-migration-tool library, allowing you to migrate files from Amazon S3 to Storacha (Web3.Storage) with detailed progress tracking."}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[(0,t.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow-sm",children:[(0,t.jsx)("h3",{className:"font-medium text-storacha",children:"Step 1: Configure"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Enter your S3 credentials and Storacha email to set up the migration."})]}),(0,t.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow-sm",children:[(0,t.jsx)("h3",{className:"font-medium text-storacha",children:"Step 2: Migrate"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Start the migration and watch real-time progress as your file moves to Storacha."})]}),(0,t.jsxs)("div",{className:"p-4 bg-white rounded-lg shadow-sm",children:[(0,t.jsx)("h3",{className:"font-medium text-storacha",children:"Step 3: Access"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Once migrated, receive the IPFS CID and URL to access your file on the decentralized web."})]})]})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);